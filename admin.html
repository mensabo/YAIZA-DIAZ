<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Administrar Galerías</title>
    <link rel="stylesheet" href="admin.css">
</head>
<body>
    <div id="login-container">
        <h2>Acceso al Panel</h2>
        <input type="email" id="email" placeholder="Email">
        <input type="password" id="password" placeholder="Contraseña">
        <button id="login-button">Entrar</button>
    </div>

    <div id="admin-panel" style="display:none;">
        <header>
            <!-- Título principal actualizado -->
            <h1>Gestionar Galerías</h1>
            <button id="logout-button">Cerrar Sesión</button>
        </header>

        <!-- AÑADIDO: Selector de galería -->
        <div class="gallery-selector-container">
            <label for="gallery-selector">Selecciona la galería a editar:</label>
            <select id="gallery-selector">
                <option value="gallery">Galería del Libro</option>
                <option value="modeling_gallery">Galería de Modelaje</option>
            </select>
        </div>

        <!-- AÑADIDO: Título dinámico para la galería actual -->
        <h2 id="current-gallery-title"></h2>

        <div id="drop-zone">
            <p>Arrastra y suelta las fotos aquí o haz clic para seleccionarlas</p>
            <input type="file" id="file-input" multiple accept="image/*" style="display:none;">
        </div>
        
        <p>Arrastra las imágenes para reordenarlas. Edita la descripción y pulsa Guardar.</p>
        <div id="gallery-list"></div>
        <button id="save-button">Guardar Cambios</button>
    </div>
    
    <!-- 1. Carga la configuración desde el archivo externo -->
    <script src="config.js"></script>

    <!-- 2. SDK de Firebase v9 (Recomendado) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-auth.js";
        import { getFirestore, collection, getDocs, orderBy, query, addDoc, writeBatch, doc, deleteDoc } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL, deleteObject } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-storage.js";

        // La variable 'firebaseConfig' ahora viene del archivo config.js
      
        // Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);

        // Hacemos las funciones y variables accesibles globalmente
        window.firebaseServices = {
            auth, signInWithEmailAndPassword, onAuthStateChanged, signOut,
            db, collection, getDocs, orderBy, query, addDoc, writeBatch, doc, deleteDoc,
            storage, ref, uploadBytes, getDownloadURL, deleteObject
        };
    </script>

    <!-- Librería para arrastrar y soltar -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    
    <!-- Nuestro script de administración -->
    <script src="admin.js" type="module"></script>
</body>
</html>